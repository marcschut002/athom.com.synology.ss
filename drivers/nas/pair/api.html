<script>
    Homey.setTitle( Homey.__('pair.api.title') );

    const api_form = document.getElementById('api-form');
    api_form.onsubmit = submit;

    function submit(event) {

        // show loading overlay
        Homey.showLoadingOverlay();

        var data = {
            'protocol': document.querySelector('input[name="protocol"]:checked').value,
            'host': document.getElementById("host").value,
            'port': document.getElementById("port").value,
            'account': document.getElementById("account").value,
            'passwd': document.getElementById("passwd").value,
        };

        Homey.emit( 'nas-api', data, function( err, result ){
            if(err !== null) {
                Homey.hideLoadingOverlay();
                // show error if any
                Homey.alert(err, 'error');
            } else if(result===true) {
                console.log('login in progress');
            } else {
                Homey.hideLoadingOverlay();
                Homey.alert(result, 'error');
            }
        });

        // For this example, don't actually submit the form
        event.preventDefault();
    }

    Homey.on('nas-api-ok', function( message, callback ){
        Homey.emit('sid', { sid: message }, function(err, result){
            if(result===true) {
                Homey.showView('list_devices');
            }
            Homey.hideLoadingOverlay();
        });
    });

    Homey.on('nas-api-error', function( message, callback ){
        Homey.hideLoadingOverlay();
        Homey.alert( message, 'error' );
    });

</script>
<style>
    .hy-input-radio {
        margin: 10px 0;
    }

    svg {
        width: 30%;
        margin-left: 35%;
    }

    .hy-tmpl-api-logo {
        margin: 5px 0;
    }

    input {
        margin-top: 4px;
    }

    #https-label {
        margin-right: 10px;
    }

    .hy-tmpl-api-row {
        padding: 4px;
    }

    h1,p {
        text-align: center;
    }

    p {
        font-size: 12px;
    }
</style>
<h1 data-i18n="pair.api.title">Synology</h1>
<div class="hy-tmpl-api-logo">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 128 128" xml:space="preserve"><style type="text/css">
	.st0{display:none;}
    .st1{display:inline;}
    .st2{fill:none;stroke:#000000;stroke-width:0.1;stroke-miterlimit:10;}
    .st3{fill:none;stroke:#000000;stroke-width:5;stroke-miterlimit:10;}
    .st4{fill:none;stroke:#020202;stroke-width:5;stroke-miterlimit:10;}
    .st5{fill:none;stroke:#000000;stroke-width:5;stroke-linecap:round;stroke-miterlimit:10;}
    .st6{fill:none;stroke:#000000;stroke-width:5;stroke-linecap:round;stroke-linejoin:round;}
    .st7{fill:none;stroke:#000000;stroke-width:5;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;}
    .st8{fill:none;stroke:#000000;stroke-width:5;stroke-miterlimit:10;stroke-dasharray:2.0066,2.0066;}
    .st9{fill:none;}
    .st10{fill:none;stroke:#000000;stroke-width:5;stroke-miterlimit:10;stroke-dasharray:2;}
    .st11{fill:none;stroke:#000000;stroke-width:5;stroke-miterlimit:10;stroke-dasharray:3;}
    .st12{fill:none;stroke:#000000;stroke-width:5;stroke-linejoin:round;stroke-miterlimit:10;}
</style><g class="st0"><g class="st1"><rect class="st2" width="128" height="128"/><line class="st2" x1="0" y1="124" x2="128" y2="124"/><line class="st2" x1="0" y1="120" x2="128" y2="120"/><line class="st2" x1="0" y1="116" x2="128" y2="116"/><line class="st2" x1="0" y1="112" x2="128" y2="112"/><line class="st2" x1="0" y1="108" x2="128" y2="108"/><line class="st2" x1="0" y1="104" x2="128" y2="104"/><line class="st2" x1="0" y1="100" x2="128" y2="100"/><line class="st2" x1="0" y1="96" x2="128" y2="96"/><line class="st2" x1="0" y1="92" x2="128" y2="92"/><line class="st2" x1="0" y1="88" x2="128" y2="88"/><line class="st2" x1="0" y1="84" x2="128" y2="84"/><line class="st2" x1="0" y1="80" x2="128" y2="80"/><line class="st2" x1="0" y1="76" x2="128" y2="76"/><line class="st2" x1="0" y1="72" x2="128" y2="72"/><line class="st2" x1="0" y1="68" x2="128" y2="68"/><line class="st2" x1="0" y1="64" x2="128" y2="64"/><line class="st2" x1="0" y1="60" x2="128" y2="60"/><line class="st2" x1="0" y1="56" x2="128" y2="56"/><line class="st2" x1="0" y1="52" x2="128" y2="52"/><line class="st2" x1="0" y1="48" x2="128" y2="48"/><line class="st2" x1="0" y1="44" x2="128" y2="44"/><line class="st2" x1="0" y1="40" x2="128" y2="40"/><line class="st2" x1="0" y1="36" x2="128" y2="36"/><line class="st2" x1="0" y1="32" x2="128" y2="32"/><line class="st2" x1="0" y1="28" x2="128" y2="28"/><line class="st2" x1="0" y1="24" x2="128" y2="24"/><line class="st2" x1="0" y1="20" x2="128" y2="20"/><line class="st2" x1="0" y1="16" x2="128" y2="16"/><line class="st2" x1="0" y1="12" x2="128" y2="12"/><line class="st2" x1="0" y1="8" x2="128" y2="8"/><line class="st2" x1="0" y1="4" x2="128" y2="4"/><line class="st2" x1="124" y1="0" x2="124" y2="128"/><line class="st2" x1="120" y1="0" x2="120" y2="128"/><line class="st2" x1="116" y1="0" x2="116" y2="128"/><line class="st2" x1="112" y1="0" x2="112" y2="128"/><line class="st2" x1="108" y1="0" x2="108" y2="128"/><line class="st2" x1="104" y1="0" x2="104" y2="128"/><line class="st2" x1="100" y1="0" x2="100" y2="128"/><line class="st2" x1="96" y1="0" x2="96" y2="128"/><line class="st2" x1="92" y1="0" x2="92" y2="128"/><line class="st2" x1="88" y1="0" x2="88" y2="128"/><line class="st2" x1="84" y1="0" x2="84" y2="128"/><line class="st2" x1="80" y1="0" x2="80" y2="128"/><line class="st2" x1="76" y1="0" x2="76" y2="128"/><line class="st2" x1="72" y1="0" x2="72" y2="128"/><line class="st2" x1="68" y1="0" x2="68" y2="128"/><line class="st2" x1="64" y1="0" x2="64" y2="128"/><line class="st2" x1="60" y1="0" x2="60" y2="128"/><line class="st2" x1="56" y1="0" x2="56" y2="128"/><line class="st2" x1="52" y1="0" x2="52" y2="128"/><line class="st2" x1="48" y1="0" x2="48" y2="128"/><line class="st2" x1="44" y1="0" x2="44" y2="128"/><line class="st2" x1="40" y1="0" x2="40" y2="128"/><line class="st2" x1="36" y1="0" x2="36" y2="128"/><line class="st2" x1="32" y1="0" x2="32" y2="128"/><line class="st2" x1="28" y1="0" x2="28" y2="128"/><line class="st2" x1="24" y1="0" x2="24" y2="128"/><line class="st2" x1="20" y1="0" x2="20" y2="128"/><line class="st2" x1="16" y1="0" x2="16" y2="128"/><line class="st2" x1="12" y1="0" x2="12" y2="128"/><line class="st2" x1="8" y1="0" x2="8" y2="128"/><line class="st2" x1="4" y1="0" x2="4" y2="128"/></g></g><g><g><rect x="4" y="4" class="st3" width="120" height="120"/><rect x="41.1" y="15.9" class="st3" width="70.2" height="96.1"/><line class="st3" x1="63.8" y1="17.1" x2="63.8" y2="110.5"/><line class="st3" x1="88.7" y1="17.1" x2="88.7" y2="110.5"/><circle class="st3" cx="22.3" cy="28.4" r="4.4"/><circle class="st3" cx="22.3" cy="50.7" r="4.4"/><line class="st5" x1="51.8" y1="25.1" x2="51.8" y2="31.8"/><line class="st5" x1="99.2" y1="25.1" x2="99.2" y2="31.8"/><line class="st5" x1="75.5" y1="25.1" x2="75.5" y2="31.8"/></g></g></svg>
</div>
<p data-i18n="pair.api.description" ></p>
<form id="api-form" class="hy-tmpl-api-form" action="/" method="post">
    <div class="hy-tmpl-api-row row">
        <input class="hy-input-radio" name="protocol" type="radio" id="https" value="https" checked>
        <label class="hy-label hy-tmpl-api-label" for="https" id="https-label">https</label>
        <input class="hy-input-radio" name="protocol" type="radio" id="http" value="http">
        <label class="hy-label hy-tmpl-api-label" for="http">http</label>
    </div>
    <div class="hy-tmpl-api-row row">
        <label class="hy-label hy-tmpl-api-label" for="host" data-i18n="pair.api.label_hostname" ></label>
        <input class="hy-input-text" name="host" type="text" id="host" value="" placeholder="your.synology.me" required>
    </div>
    <div class="hy-tmpl-api-row row">
        <label class="hy-label hy-tmpl-api-label" for="port" data-i18n="pair.api.label_port"></label>
        <input class="hy-input-text" name="port" type="number" id="port" value="" placeholder="5001" required>
    </div>
    <div class="hy-tmpl-api-row row">
        <label class="hy-label hy-tmpl-api-label" for="account" data-i18n="pair.api.label_account"></label>
        <input class="hy-input-text" name="account" type="text" id="account" value="" placeholder="Gebruikersnaam" required>
    </div>
    <div class="hy-tmpl-api-row row">
        <label class="hy-label hy-tmpl-api-label" for="passwd" data-i18n="pair.api.label_passwd"></label>
        <input class="hy-input-text" name="passwd" type="password" id="passwd" value="" placeholder="Wachtwoord" required>
    </div>
    <div class="hy-tmpl-api-row row">
        <input class="hy-button hy-button-primary hy-button-fill hy-tmpl-api-submit button" type="submit" data-i18n="pair.api.submit">
    </div>
</form>

